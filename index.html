<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Vergel | Frutas y Verduras</title>
    <style>
        /* --- 1. DISE√ëO BASADO EN TU LOGO --- */
        :root {
            /* Colores extra√≠dos de tu imagen */
            --naranja-logo: #F39C12; /* Fondo del logo */
            --verde-logo: #C0D92E;   /* Texto del logo */
            --verde-oscuro: #2E7D32; /* Para contrastes */
            --blanco: #ffffff;
            --gris-claro: #f4f4f4;
            --texto: #333;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            background-color: var(--gris-claro); 
            color: var(--texto);
        }

        /* Navegaci√≥n Moderna */
        nav { 
            background: var(--naranja-logo); 
            padding: 1rem 2rem; 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .logo-text {
            font-family: 'Brush Script MT', cursive; /* Tipograf√≠a estilo manuscrito */
            font-size: 2rem;
            color: var(--verde-logo);
            text-shadow: 1px 1px 0 #000; /* Borde negro suave como el logo */
            text-decoration: none;
        }

        .nav-links { display: flex; gap: 15px; }
        
        .nav-btn { 
            background: transparent; 
            border: none; 
            color: white; 
            font-weight: bold; 
            font-size: 1rem; 
            cursor: pointer; 
            padding: 8px 15px; 
            border-radius: 20px; 
            transition: 0.3s;
        }

        .nav-btn:hover, .nav-btn.active { 
            background: var(--verde-logo); 
            color: #000; 
        }

        /* Secciones */
        section { 
            display: none; /* Ocultas por defecto */
            padding: 30px 20px; 
            max-width: 1200px; 
            margin: 0 auto; 
            animation: fadeIn 0.5s ease-in-out;
        }
        
        /* El Home siempre visible al inicio */
        #home { display: block; } 

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Estilos de Tarjetas (Grid) */
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        
        .card { 
            background: var(--blanco); 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); 
            transition: transform 0.3s; 
            border-bottom: 5px solid var(--naranja-logo);
        }
        
        .card:hover { transform: translateY(-5px); }
        .card img { width: 100%; height: 200px; object-fit: cover; }
        .card-body { padding: 20px; text-align: center; }
        .card h3 { color: var(--verde-oscuro); margin-top: 0; }

        /* Botones de Acci√≥n */
        .btn-action {
            background-color: var(--naranja-logo);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin-top: 10px;
            transition: 0.3s;
        }
        .btn-action:hover { background-color: var(--verde-oscuro); }

        /* Banner Principal */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://images.unsplash.com/photo-1610832958506-aa56368176cf?q=80&w=1470&auto=format&fit=crop'); 
            background-size: cover; 
            background-position: center; 
            color: white; 
            text-align: center; 
            padding: 80px 20px; 
            border-radius: 0 0 20px 20px;
            margin-bottom: 40px;
        }
        .hero h1 { font-size: 3.5rem; margin: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); font-family: 'Brush Script MT', cursive; color: var(--verde-logo); -webkit-text-stroke: 1px black; }
        .hero p { font-size: 1.5rem; margin-top: 10px; text-shadow: 1px 1px 2px black; }

        .btn-sm { background:#ddd; border:none; width:30px; height:30px; border-radius:50%; font-weight:bold; cursor:pointer; }
.btn-sm:hover { background: var(--verde-logo); }

    </style>
</head>
<body>

    <nav>
        <a href="#" onclick="navegar('home')" class="logo-text">El Vergel</a>
        <div class="nav-links">
            <button class="nav-btn active" onclick="navegar('home')">Inicio</button>
            <button class="nav-btn" onclick="navegar('pedidos')">Pedidos</button>
            <button class="nav-btn" onclick="navegar('tips')">Tips</button>
            <button class="nav-btn" onclick="navegar('recetas')">Recetas</button>
            <button class="nav-btn" onclick="navegar('contacto')">Contacto</button>
        </div>
    </nav>

    <section id="home">
        <div class="hero">
            <h1>El Vergel</h1>
            <p>Frutas y Verduras Frescas</p>
        </div>

        <h2 style="text-align: center; color: var(--texto); margin-bottom: 30px;">Explora nuestra tienda</h2>
        
        <div class="grid-container">
            <div class="card">
                <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=500" alt="Pedidos">
                <div class="card-body">
                    <h3>Haz tu Pedido</h3>
                    <p>Selecciona tus frutas y verduras favoritas por kg o unidad. ¬°Tenemos ofertas incre√≠bles!</p>
                    <button onclick="navegar('pedidos')" class="btn-action">Ir a Pedidos üõí</button>
                </div>
            </div>

            <div class="card">
                <img src="https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=500" alt="Tips">
                <div class="card-body">
                    <h3>Tips Saludables</h3>
                    <p>Descubre c√≥mo conservar mejor tus alimentos y beneficios para tu salud.</p>
                    <button onclick="navegar('tips')" class="btn-action">Ver Tips üí°</button>
                </div>
            </div>

            <div class="card">
                <img src="https://images.unsplash.com/photo-1495521821757-a1efb6729352?w=500" alt="Recetas">
                <div class="card-body">
                    <h3>Recetas de la Abuela</h3>
                    <p>Cocina delicioso con nuestros productos frescos. ¬°Mira los videos!</p>
                    <button onclick="navegar('recetas')" class="btn-action">Ver Recetas üç≥</button>
                </div>
            </div>

            <div class="card">
                <img src="https://images.unsplash.com/photo-1534536281715-e28d76689b4d?w=500" alt="Contacto">
                <div class="card-body">
                    <h3>Cont√°ctanos</h3>
                    <p>¬øDudas? ¬øSugerencias? Estamos aqu√≠ para escucharte.</p>
                    <button onclick="navegar('contacto')" class="btn-action">Escr√≠benos üìû</button>
                </div>
            </div>
        </div>
    </section>

    <section id="pedidos">
        <h2 style="color: var(--naranja-logo);">üì¶ Realiza tu Pedido</h2>
        <div id="productos-grid" class="grid-container">
            <p>Cargando productos frescos...</p>
        </div>
    </section>

    <section id="tips">
        <h2 style="color: var(--naranja-logo);">üí° Tips Saludables</h2>
        <div id="tips-grid" class="grid-container">Cargando tips...</div>
    </section>

    <section id="recetas">
        <h2 style="color: var(--naranja-logo);">üç≥ Recetas Deliciosas</h2>
        <div id="recetas-grid" class="grid-container">Cargando recetas...</div>
    </section>

    <section id="contacto">
        <h2 style="color: var(--naranja-logo);">üìû Contacto</h2>
        <div style="background: white; padding: 30px; border-radius: 15px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
            <p>üìç Direcci√≥n: Calle Falsa 123</p>
            <p>üìß Email: geeneral@elvergelfrutasyverduras.com</p>
            <hr>
            <h3>D√©janos tu opini√≥n</h3>
            <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                <a href="LINK_SUGERENCIAS" target="_blank" class="btn-action" style="background: var(--verde-oscuro);">Buz√≥n de Sugerencias</a>
                <a href="LINK_RECLAMOS" target="_blank" class="btn-action" style="background: #d9534f;">Libro de Reclamos</a>
            </div>
        </div>
    </section>

// ‚ö†Ô∏è PEGA AQU√ç TU URL DEL SCRIPT DE GOOGLE ‚ö†Ô∏è
    const API_URL = 'AQUI_VA_TU_URL_DEL_SCRIPT_DE_GOOGLE'; 

    let carrito = [];
    let productosGlobal = []; // Para guardar la lista y buscar precios r√°pido

    // --- 1. FUNCI√ìN DE NAVEGACI√ìN ---
    function navegar(seccionId) {
        const secciones = document.querySelectorAll('section');
        secciones.forEach(sec => sec.style.display = 'none');

        const seccionMostrar = document.getElementById(seccionId);
        if(seccionMostrar) seccionMostrar.style.display = 'block';

        // Actualizar men√∫ activo
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        // L√≥gica simple para resaltar el bot√≥n
        const btnActivo = Array.from(document.querySelectorAll('.nav-btn')).find(b => 
            b.innerText.toLowerCase().includes(seccionId === 'home' ? 'inicio' : seccionId)
        );
        if(btnActivo) btnActivo.classList.add('active');
    }

    // --- 2. CARGA DE DATOS ---
    window.onload = () => {
        cargarProductos();
    };

    function cargarProductos() {
        fetch(API_URL + '?action=getProductos')
        .then(r => r.json())
        .then(data => {
            productosGlobal = data; // Guardamos en memoria
            const container = document.getElementById('productos-grid');
            container.innerHTML = ''; 
            
            data.forEach(p => {
                if(p.Disponible === "FALSE" || p.Disponible === false) return;

                // L√≥gica de pasos: 0.1 para kg, 1 para unidades
                const esKg = p.Unidad.toLowerCase() === 'kg';
                const paso = esKg ? 0.1 : 1;
                const min = esKg ? 0.1 : 1;

                // Botones r√°pidos solo para Kilos
                const botonesExtra = esKg ? `
                    <div style="margin-bottom:10px;">
                        <button onclick="fijarCantidad('${p.ID_Producto}', 0.5)" class="btn-sm">¬Ω kg</button>
                        <button onclick="fijarCantidad('${p.ID_Producto}', 1)" class="btn-sm">1 kg</button>
                    </div>` : '';

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <img src="${p.Imagen || 'https://via.placeholder.com/300'}" alt="${p.Nombre}">
                    <div class="card-body">
                        <h3>${p.Nombre}</h3>
                        <p style="color:var(--naranja-logo); font-weight:bold; font-size:1.2rem;">
                            $${p.Precio_Regular} / ${p.Unidad}
                        </p>
                        ${p.Precio_Oferta ? `<p style="color:green; font-size:0.9rem;">üî• Oferta: $${p.Precio_Oferta} llevando +${p.Minimo_Oferta} ${p.Unidad}</p>` : ''}
                        
                        ${botonesExtra}

                        <div style="display:flex; align-items:center; justify-content:center; gap:10px; margin-bottom:10px;">
                            <button onclick="cambiarInput('${p.ID_Producto}', -${paso})" class="btn-sm">-</button>
                            <input id="cant-${p.ID_Producto}" type="number" value="${min}" step="${paso}" min="${min}" style="width:50px; text-align:center; font-size:1.1rem; border:1px solid #ddd; border-radius:5px;">
                            <span>${p.Unidad}</span>
                            <button onclick="cambiarInput('${p.ID_Producto}', ${paso})" class="btn-sm">+</button>
                        </div>

                        <button onclick="agregar('${p.ID_Producto}')" class="btn-action">Agregar üõí</button>
                    </div>
                `;
                container.appendChild(card);
            });
        })
        .catch(e => console.log("Error:", e));
    }

    // --- 3. L√ìGICA DEL CARRITO (Aqu√≠ aplicamos tu correcci√≥n) ---
    
    // Auxiliares para los inputs
    function cambiarInput(id, delta) {
        const input = document.getElementById('cant-'+id);
        let val = parseFloat(input.value) + delta;
        if(val < 0.1) val = 0.1;
        input.value = Math.round(val * 100) / 100; // Evitar errores de decimales (0.300004)
    }
    function fijarCantidad(id, val) { document.getElementById('cant-'+id).value = val; }

    function agregar(id) {
        const prod = productosGlobal.find(p => p.ID_Producto === id);
        const input = document.getElementById('cant-'+id);
        const cantidad = parseFloat(input.value);

        // AQUI EST√Å TU L√ìGICA MAYOR O IGUAL
        let precioFinal = prod.Precio_Regular;
        if (prod.Precio_Oferta && cantidad >= prod.Minimo_Oferta) {
            precioFinal = prod.Precio_Oferta;
            alert(`¬°Genial! Aplicaste oferta mayorista en ${prod.Nombre} üéâ`);
        }

        // Buscar si ya existe en el carrito
        const existente = carrito.find(item => item.id === id);
        
        if (existente) {
            existente.cantidad += cantidad;
            // Re-verificar oferta con la nueva cantidad total
            if (prod.Precio_Oferta && existente.cantidad >= prod.Minimo_Oferta) {
                existente.precio = prod.Precio_Oferta;
            }
        } else {
            carrito.push({
                id: id,
                nombre: prod.Nombre,
                precio: precioFinal,
                cantidad: cantidad,
                unidad: prod.Unidad
            });
        }
        
        alert(`Agregado: ${cantidad} ${prod.Unidad} de ${prod.Nombre}`);
        console.log("Carrito actual:", carrito); // M√≠ralo en la consola con F12
    }
</body>
</html>




